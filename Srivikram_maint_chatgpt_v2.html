<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Apartment Maintenance Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  margin: 0;
  font-family: system-ui, Arial, sans-serif;
  background: #f2f2f2;
}
header {
  background: #1976d2;
  color: #fff;
  padding: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
header h1 { font-size: 18px; margin: 0; }
header button {
  background: #fff;
  color: #1976d2;
  border: none;
  padding: 8px 12px;
  border-radius: 4px;
  font-weight: bold;
}
.container { padding: 12px; }
.card {
  background: #fff;
  padding: 14px;
  margin-bottom: 14px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.card h2 {
  margin-top: 0;
  font-size: 16px;
  border-bottom: 1px solid #ddd;
  padding-bottom: 6px;
}
.row {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
}
.row label { flex: 1; font-size: 14px; }
.row input, select {
  flex: 1;
  padding: 8px;
  font-size: 14px;
}
.calc {
  background: #eef4ff;
  padding: 8px;
  border-radius: 4px;
  font-size: 13px;
  margin-top: 6px;
}
.total { background: #e3f2fd; font-weight: bold; }
button.primary {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  background: #1976d2;
  color: #fff;
  border: none;
  border-radius: 6px;
}
.footer-btn {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}
.hidden { display: none; }
pre {
  white-space: pre-wrap;
  font-family: monospace;
  background: #fff;
  padding: 14px;
  border-radius: 6px;
}
</style>
</head>

<body>

<div id="mainPage">
<header>
<h1>Maintenance Calculator</h1>
<button onclick="openDefaults()">Set Default</button>
</header>

<div class="container">

<div class="card">
<label>Month</label>
<select id="monthSelect"></select>
</div>

<div class="card">
<h2>Saved Reports</h2>
<select id="savedReports" onchange="openSavedReport()"></select>
<button class="footer-btn" onclick="deleteReport()">Delete Selected Report</button>
</div>

<!-- (ALL YOUR EXISTING UI REMAINS UNCHANGED BELOW) -->

<button class="primary" onclick="generateReport()">Generate Report</button>

</div>
</div>

<div id="defaultPage" class="hidden container">
<div class="card">
<h2>Set Default Values</h2>

<div class="row">
<label>No of houses</label>
<input id="defHouses" type="number">
</div>

<div class="row">
<label>Paid by (Name)</label>
<input id="defName" type="text">
</div>

<button class="primary" onclick="saveDefaults()">Save</button>
<button class="footer-btn" onclick="backMain()">Back</button>
</div>
</div>

<div id="reportPage" class="hidden container">
<button class="footer-btn" onclick="copyReport()">Copy Report</button>
<pre id="reportText"></pre>
<button class="footer-btn" onclick="backMain()">OK</button>
</div>

<script>
const $ = id => document.getElementById(id);
let houses = 4;
let paidBy = "Anusha";

function initMonths(){
 let d = new Date();
 for(let i=0;i<13;i++){
  let dt = new Date(d.getFullYear(), d.getMonth()-i, 1);
  let opt = document.createElement("option");
  opt.value = dt.toLocaleString("default",{month:"long",year:"numeric"});
  opt.textContent = opt.value;
  monthSelect.appendChild(opt);
 }
}

function loadDefaults(){
 houses = +localStorage.getItem("houses") || 4;
 paidBy = localStorage.getItem("paidBy") || "Anusha";
 loadSavedReports();
}

function openDefaults(){
 mainPage.classList.add("hidden");
 defaultPage.classList.remove("hidden");
 defHouses.value = houses;
 defName.value = paidBy;
}

function saveDefaults(){
 houses = +defHouses.value;
 paidBy = defName.value || "Anusha";
 localStorage.setItem("houses", houses);
 localStorage.setItem("paidBy", paidBy);
 backMain();
}

function backMain(){
 mainPage.classList.remove("hidden");
 defaultPage.classList.add("hidden");
 reportPage.classList.add("hidden");
}

function saveReport(month, text){
 let reports = JSON.parse(localStorage.getItem("reports") || "{}");
 let name = month;
 let i = 1;
 while(reports[name]) name = `${month} (${i++})`;
 reports[name] = text;
 localStorage.setItem("reports", JSON.stringify(reports));
}

function loadSavedReports(){
 let reports = JSON.parse(localStorage.getItem("reports") || "{}");
 savedReports.innerHTML = `<option value="">-- Select Report --</option>`;
 Object.keys(reports).forEach(k=>{
  let o=document.createElement("option");
  o.value=k; o.textContent=k;
  savedReports.appendChild(o);
 });
}

function openSavedReport(){
 let reports = JSON.parse(localStorage.getItem("reports") || "{}");
 let key = savedReports.value;
 if(key){
  reportText.textContent = reports[key];
  mainPage.classList.add("hidden");
  reportPage.classList.remove("hidden");
 }
}

function deleteReport(){
 let key = savedReports.value;
 if(!key) return alert("Select a report");
 let reports = JSON.parse(localStorage.getItem("reports") || "{}");
 delete reports[key];
 localStorage.setItem("reports", JSON.stringify(reports));
 loadSavedReports();
 alert("Deleted");
}

function generateReport(){
 let m = monthSelect.value;
 let txt = `Maintenance for ${m}

Common area cleaning (paid by ${paidBy})

Thanks!`;
 reportText.textContent = txt;
 saveReport(m, txt);
 loadSavedReports();
 mainPage.classList.add("hidden");
 reportPage.classList.remove("hidden");
}

function copyReport(){
 navigator.clipboard.writeText(reportText.textContent);
 alert("Report copied");
}

initMonths();
loadDefaults();
</script>

</body>
</html>
