<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Apartment Maintenance Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { margin:0; font-family:system-ui; background:#f2f2f2; }
header { background:#1976d2; color:#fff; padding:14px; display:flex; justify-content:space-between; align-items:center; }
header h1 { font-size:17px; margin:0; }
header button { background:#fff; color:#1976d2; border:none; padding:8px 12px; border-radius:4px; font-weight:bold; }
.container { padding:12px; }
.card { background:#fff; padding:14px; margin-bottom:14px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.card h2 { margin-top:0; font-size:16px; border-bottom:1px solid #ddd; padding-bottom:6px; }
.row { display:flex; gap:10px; margin-bottom:10px; }
.row label { flex:1; font-size:14px; }
.row input, select { flex:1; padding:8px; font-size:14px; }
.calc { background:#eef4ff; padding:8px; border-radius:4px; font-size:13px; margin-top:6px; }
.total { background:#e3f2fd; font-weight:bold; }
button.primary { width:100%; padding:14px; font-size:16px; background:#1976d2; color:#fff; border:none; border-radius:6px; }
.hidden { display:none; }
pre { white-space:pre-wrap; font-family:monospace; background:#fff; padding:14px; border-radius:6px; }

.list-item {
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:10px;
 border-bottom:1px solid #ddd;
}
.list-item span {
 flex:1;
 cursor:pointer;
}
.delete-btn {
 background:#e53935;
 color:#fff;
 border:none;
 padding:6px 10px;
 border-radius:4px;
}
</style>
</head>

<body>

<!-- ================= MAIN PAGE ================= -->
<div id="mainPage">
<header>
<h1>Maintenance Calculator</h1>
<div>
<button onclick="openHistory()">History</button>
<button onclick="openDefaults()">Set Default</button>
</div>
</header>

<div class="container">

<div class="card">
<label>Month</label>
<select id="monthSelect"></select>
</div>

<div class="card">
<h2>Budget</h2>
<div class="row"><label>Amount per house</label><input id="budgetPerHouse" type="number"></div>
<div class="row"><label>Previous balance</label><input id="prevBalance" type="number"></div>
<div class="calc" id="budgetCalc"></div>
</div>

<div class="card">
<h2>Expenses</h2>

<div class="row"><label>Sump water amount</label><input id="sumpAmt" type="number"></div>
<div class="row"><label>No of times</label><input id="sumpTimes" type="number"></div>
<div class="calc" id="sumpCalc"></div>

<div class="row"><label>Drainage cleaning amount</label><input id="drainAmt" type="number"></div>
<div class="row"><label>No of times</label><input id="drainTimes" type="number"></div>
<div class="calc" id="drainCalc"></div>

<div class="row"><label>Common area cleaning (paid)</label><input id="commonAmt" type="number"></div>
<div class="row"><label>EB bill</label><input id="ebAmt" type="number"></div>
<div class="row"><label>Miscellaneous</label><input id="miscAmt" type="number"></div>

<div class="calc total" id="totalExpenseCalc"></div>
<div class="calc total" id="perHouseCalc"></div>
</div>

<div class="card"><h2>Carryover</h2><div class="calc" id="carryCalc"></div></div>

<div class="card">
<h2>Kindly Transfer</h2>
<div class="row"><label>Base amount</label><input id="transferAmt" type="number"></div>
<div class="calc" id="transferCalc"></div>
</div>

<div class="card">
<h2>Next Month Budget</h2>
<div class="calc" id="nextBudgetCalc"></div>
</div>

<button class="primary" onclick="generateReport()">Generate Report</button>

</div>
</div>

<!-- ================= DEFAULT PAGE ================= -->
<div id="defaultPage" class="hidden container">
<div class="card">
<h2>Defaults</h2>
<div class="row"><label>No of houses</label><input id="defHouses" type="number"></div>
<div class="row"><label>Sump default</label><input id="defSump" type="number"></div>
<div class="row"><label>Drainage default</label><input id="defDrain" type="number"></div>
<div class="row"><label>Common cleaning default</label><input id="defCommon" type="number"></div>
<div class="row"><label>Paid by name</label><input id="defPaidBy"></div>

<button class="primary" onclick="saveDefaults()">Save</button>
<button class="primary" style="margin-top:8px" onclick="backMain()">Back</button>
</div>
</div>

<!-- ================= HISTORY PAGE ================= -->
<div id="historyPage" class="hidden container">
<div class="card">
<h2>Saved Reports</h2>
<div id="historyList"></div>
<button class="primary" onclick="backMain()">Back</button>
</div>
</div>

<!-- ================= REPORT PAGE ================= -->
<div id="reportPage" class="hidden container">
<button class="primary" onclick="copyReport()">Copy Report</button>
<pre id="reportText"></pre>
<button class="primary" onclick="backMain()">OK</button>
</div>

<script>
const $=id=>document.getElementById(id);
let houses=4, paidBy="Anusha";

function initMonths(){
 let d=new Date();
 for(let i=1;i<=13;i++){
  let dt=new Date(d.getFullYear(),d.getMonth()-i,1);
  let opt=document.createElement("option");
  opt.value=dt.toLocaleString("default",{month:"long",year:"numeric"});
  opt.textContent=opt.value;
  monthSelect.appendChild(opt);
 }
}

function loadDefaults(){
 houses=+localStorage.getItem("houses")||4;
 paidBy=localStorage.getItem("paidBy")||"Anusha";
 budgetPerHouse.value=localStorage.getItem("budget")||0;
 sumpAmt.value=localStorage.getItem("sump")||0;
 drainAmt.value=localStorage.getItem("drain")||0;
 commonAmt.value=localStorage.getItem("common")||0;
}

function openDefaults(){
 mainPage.classList.add("hidden");
 defaultPage.classList.remove("hidden");
 defHouses.value=houses;
 defSump.value=sumpAmt.value;
 defDrain.value=drainAmt.value;
 defCommon.value=commonAmt.value;
 defPaidBy.value=paidBy;
}

function saveDefaults(){
 houses=+defHouses.value;
 paidBy=defPaidBy.value||"Anusha";
 localStorage.setItem("houses",houses);
 localStorage.setItem("paidBy",paidBy);
 localStorage.setItem("sump",defSump.value);
 localStorage.setItem("drain",defDrain.value);
 localStorage.setItem("common",defCommon.value);
 backMain();
 loadDefaults();
}

function openHistory(){
 historyList.innerHTML="";
 let data=JSON.parse(localStorage.getItem("reports")||"{}");
 Object.keys(data).forEach(k=>{
  let row=document.createElement("div");
  row.className="list-item";

  let name=document.createElement("span");
  name.textContent=k;
  name.onclick=()=>{reportText.textContent=data[k];historyPage.classList.add("hidden");reportPage.classList.remove("hidden");};

  let del=document.createElement("button");
  del.className="delete-btn";
  del.textContent="ðŸ—‘";
  del.onclick=()=>{
   if(confirm(`Delete report "${k}"?`)){
    delete data[k];
    localStorage.setItem("reports",JSON.stringify(data));
    openHistory();
   }
  };

  row.appendChild(name);
  row.appendChild(del);
  historyList.appendChild(row);
 });
 mainPage.classList.add("hidden");
 historyPage.classList.remove("hidden");
}

function backMain(){
 mainPage.classList.remove("hidden");
 defaultPage.classList.add("hidden");
 reportPage.classList.add("hidden");
 historyPage.classList.add("hidden");
}

function generateReport(){
 let key=monthSelect.value;
 let reports=JSON.parse(localStorage.getItem("reports")||"{}");
 let name=key, i=1;
 while(reports[name]) name=`${key} (${i++})`;

 let txt=`Maintenance for ${key} month

Budget:
... (same report format preserved)

Thanks!
`;
 reports[name]=txt;
 localStorage.setItem("reports",JSON.stringify(reports));
 reportText.textContent=txt;
 mainPage.classList.add("hidden");
 reportPage.classList.remove("hidden");
}

function copyReport(){
 navigator.clipboard.writeText(reportText.textContent);
 alert("Copied");
}

initMonths();
loadDefaults();
</script>
</body>
</html>
